<!DOCTYPE html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta charset="UTF-8">
	<title>Telegram redirector</title>
	<link rel="icon" href="favicon.ico" type="image/x-icon" />
	<style type="text/css">%CSS%</style>
</head>
<body>
	<div id="outer">
		<div id="inner">
			<a href="tg://resolve?domain=design_labodina_blog" id="active_link" class="btn btn-pulse" role="button" aria-pressed="true">Open in Telegram</a>
			<div id="timer" class="mt-15">
				Redirecting....
			</div>
		</div>
	</div>

<script>
	console.log('Made by https://spartak.io', 'Github page https://github.com/mrspartak/tg-redirect');
	
	var urlParams = new URLSearchParams(window.location.search);
	var count_q = urlParams.get('counter');
	var count = count_q ? +count_q : +'%COUNTER%';

	var redirectlink = "";
	var link = document.getElementById("active_link");
	var path = document.location.pathname;

	if(path.indexOf('/joinchat/') != -1) {
		var chat = path.replace('/joinchat/', '');
		var redirectlink = "tg://" + "join?invite="+ chat;
		link.innerHTML = 'Join chat in Telegram';
	} else if(path.indexOf('/addstickers/') != -1) {
		var stickers = path.replace('/addstickers/', '');
		var redirectlink = "tg://" + "addstickers?set="+ stickers;
		link.innerHTML = 'Add stickers in Telegram';
	} else {
		var domain = path.replace(/^\//, '');
		var isPost = domain.split('/');

		if(isPost.length == 2) {
			redirectlink = "tg://" + "resolve?domain="+ isPost[0] +'&post='+ isPost[1];
			link.innerHTML = 'Open post in Telegram';
		} else {
			redirectlink = "tg://" + "resolve?domain="+ domain;
			link.innerHTML = 'Open in Telegram';
		}
	}
	
	link.href = redirectlink;

	function counter() {
		var timer = document.getElementById("timer");

		if (count > 0) {
			count--;
			timer.innerHTML = "You will be redirected in  " + count + " sec.";
			setTimeout(counter, 1000);
		} else {
			redirect(redirectlink);
			timer.innerHTML = "Redirecting...";
		}
	}

	function redirect(url) {
		document.location = url;
	}

	counter();
</script>
</body>
</html>