<!DOCTYPE html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta charset="UTF-8">
	<title>Telegram redirector</title>
	<link rel="icon" type="image/x-icon" href="favicon.ico" />
	<style type="text/css">%CSS%</style>
</head>
<body>
	<div id="outer">
		<div id="inner" class="inner-index">
			<script>
			console.log('Made by https://spartak.io', 'Github page https://github.com/mrspartak/tg-redirect');
			function keyPressed(event) {
				if (event.keyCode == 13) convert()
			}

			function convert(){
				var error = document.getElementById("error");
				var website = document.location.host;
				var value = document.getElementById("inputUrl").value;
				if(!value) {
					error.className = 'text-error mb-5';
					error.innerHTML = 'No link provided';
					return;
				}
				value = value.trim().toLocaleLowerCase();
				baseValue = value;

				if(value.indexOf('t.me') == -1 && value.indexOf('@') == -1) {
					error.className = 'text-error mb-5';
					error.innerHTML = 'Wrong link format';
					return;
				}

				error.className = 'hidden';

				var baseScheme = false;
				if(value.indexOf('http://') != -1) baseScheme = 'http://';
				if(value.indexOf('https://') != -1) baseScheme = 'https://';

				var currentScheme = document.location.protocol +'//';

				var value = value.replace("t.me", website).replace("@", currentScheme + website +"/");
				if(baseScheme) value = value.replace(baseScheme, currentScheme);
				else if(baseValue.indexOf('t.me') != -1) value = currentScheme + value;

				document.getElementById("inputUrl").value = value;

				var link = document.getElementById("active_link");
				link.href = value;
				link.className = 'btn display-block mt-25';

				var copyBtn = document.getElementById("copy");
				copyBtn.className = 'btn ml-5';
			}

			function copy() {
				var value = document.getElementById("inputUrl").value;
				copyToClipboard( value.trim().toLocaleLowerCase() )
			}

			function copyToClipboard (str) {
				const el = document.createElement('textarea');
				el.value = str;
				el.setAttribute('readonly', '');
				el.style.position = 'absolute';
				el.style.left = '-9999px';
				document.body.appendChild(el);
				el.select();
				document.execCommand('copy');
				document.body.removeChild(el);
			};

			</script>

			<h3>We support:</h3>
			<p>User/Channel <b>https://t.me/user</b></p>
			<p>Short syntax <b>@user</b></p>
			<p>Post <b>https://t.me/user/10</b></p>
			<p>Chat <b>https://t.me/joinchat/lofh3p2fh</b></p>
			<p>Sticker <b>https://t.me/addstickers/random</b></p>

			<div class="mt-15">
				<span class="hidden" id="error"></span>
				<input type="text" id="inputUrl" placeholder="t.me/.." required="" autofocus="" class="input" onkeypress="keyPressed(event)">
			</div>

			<div class="mt-15">
				<button class="btn" onclick="convert()" type="button">Convert</button>
				<button class="hidden" id="copy" onclick="copy()" type="button">Copy</button>
			</div>

			
			<a class="hidden" id="active_link">Go to link</a>

			<div class="contact">
				Contact: <a href="tg://resolve?domain=catrps">@catrps</a><br>
				<a href="https://github.com/mrspartak/tg-redirect" target="_blank">Github</a>
			</div>
		</div>
	</div>
</body>
</html>